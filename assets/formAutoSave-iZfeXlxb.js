class i{constructor(e,t={}){this.formId=e,this.storageKey=`autosave_${e}`,this.options={saveInterval:3e3,excludeFields:["password","confirmPassword"],onSave:null,onRestore:null,...t},this.saveTimer=null,this.isEnabled=!0}save(e){if(this.isEnabled)try{const t=this.filterData(e),a={data:t,timestamp:new Date().toISOString(),version:"1.0"};localStorage.setItem(this.storageKey,JSON.stringify(a)),this.options.onSave&&this.options.onSave(t),console.log(`âœ… Auto-saved form: ${this.formId}`)}catch(t){console.error("Auto-save failed:",t)}}load(){try{const e=localStorage.getItem(this.storageKey);if(!e)return null;const t=JSON.parse(e),a=new Date(t.timestamp);return(new Date-a)/(1e3*60*60)>24?(this.clear(),null):(this.options.onRestore&&this.options.onRestore(t.data),console.log(`ðŸ“± Restored form data: ${this.formId}`),t.data)}catch(e){return console.error("Auto-restore failed:",e),null}}scheduleAutoSave(e){this.isEnabled&&(this.saveTimer&&clearTimeout(this.saveTimer),this.saveTimer=setTimeout(()=>{this.save(e)},this.options.saveInterval))}clear(){localStorage.removeItem(this.storageKey),this.saveTimer&&(clearTimeout(this.saveTimer),this.saveTimer=null),console.log(`ðŸ§¹ Cleared auto-save data: ${this.formId}`)}disable(){this.isEnabled=!1,this.saveTimer&&(clearTimeout(this.saveTimer),this.saveTimer=null)}enable(){this.isEnabled=!0}filterData(e){const t={...e};return this.options.excludeFields.forEach(a=>{delete t[a]}),t}hasSavedData(){const e=localStorage.getItem(this.storageKey);if(!e)return!1;try{const t=JSON.parse(e),a=new Date(t.timestamp);return(new Date-a)/(1e3*60*60)<=24}catch{return!1}}getSaveTime(){try{const e=localStorage.getItem(this.storageKey);if(!e)return null;const t=JSON.parse(e);return new Date(t.timestamp)}catch{return null}}}const u=(s,e,t={})=>{const a=new i(s,t);return{scheduleAutoSave:()=>{a.scheduleAutoSave(e)},loadSavedData:()=>a.load(),clearSavedData:()=>{a.clear()},hasSavedData:()=>a.hasSavedData(),getSaveTime:()=>a.getSaveTime(),disable:()=>a.disable(),enable:()=>a.enable()}};export{u};
