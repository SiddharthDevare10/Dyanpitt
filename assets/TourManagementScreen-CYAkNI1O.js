import{u as b,r as t,c as m,j as e}from"./index-DJTMSaIU.js";function S(){const d=b(),[x,j]=t.useState([]),[p,h]=t.useState(!0),[n,g]=t.useState(""),[a,k]=t.useState("all"),[o,N]=t.useState("");t.useEffect(()=>{r()},[]);const r=async()=>{try{h(!0);const s=await m.request("/tour/requests");j(s.data||[])}catch(s){console.error("Error fetching tours:",s),g("Failed to load tours")}finally{h(!1)}},i=async(s,c)=>{try{await m.request(`/tour/requests/${s}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:c})}),r()}catch(l){console.error("Error updating tour status:",l),alert("Failed to update tour status")}},u=x.filter(s=>{const c=a==="all"||s.tourStatus===a,l=s.fullName.toLowerCase().includes(o.toLowerCase())||s.email.toLowerCase().includes(o.toLowerCase());return c&&l}),v=s=>{switch(s){case"pending":return"#f59e0b";case"confirmed":return"#3b82f6";case"completed":return"#10b981";case"cancelled":return"#ef4444";default:return"#6b7280"}},f=()=>{d("/admin-dashboard")},C=()=>{d("/admin/qr-scanner")};return p?e.jsx("div",{className:"main-container",children:e.jsx("div",{className:"simple-loading",children:e.jsx("p",{children:"Loading tours..."})})}):e.jsxs("div",{className:"main-container tour-management-container",children:[e.jsx("button",{onClick:f,className:"back-button",children:e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M19 12H5M12 19L5 12L12 5",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsxs("div",{className:"header-section",children:[e.jsx("h1",{className:"main-title",children:"Tour Management"}),e.jsx("p",{className:"main-subtitle",children:"Manage visitor tours and QR scanning"})]}),e.jsxs("div",{className:"quick-actions",children:[e.jsxs("button",{onClick:C,className:"qr-scanner-button",children:[e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("rect",{x:"3",y:"3",width:"5",height:"5",stroke:"currentColor",strokeWidth:"2"}),e.jsx("rect",{x:"16",y:"3",width:"5",height:"5",stroke:"currentColor",strokeWidth:"2"}),e.jsx("rect",{x:"3",y:"16",width:"5",height:"5",stroke:"currentColor",strokeWidth:"2"}),e.jsx("path",{d:"M21 16H16V21",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M21 21L16 16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),"QR Scanner"]}),e.jsxs("button",{onClick:r,className:"refresh-button",children:[e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M1 4V10H7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M23 20V14H17",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10M23 14L18.36 18.36A9 9 0 0 1 3.51 15",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),"Refresh"]})]}),e.jsxs("div",{className:"tour-controls",children:[e.jsxs("div",{className:"filter-section",children:[e.jsx("label",{className:"input-label",children:"Filter by Status:"}),e.jsxs("select",{value:a,onChange:s=>k(s.target.value),className:"filter-select",children:[e.jsx("option",{value:"all",children:"All Tours"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"confirmed",children:"Confirmed"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),e.jsxs("div",{className:"search-section",children:[e.jsx("label",{className:"input-label",children:"Search:"}),e.jsx("input",{type:"text",value:o,onChange:s=>N(s.target.value),placeholder:"Search by name or email...",className:"search-input"})]})]}),e.jsxs("div",{className:"tours-list",children:[n&&e.jsxs("div",{className:"error-message",children:[e.jsx("p",{children:n}),e.jsx("button",{onClick:r,className:"retry-button",children:"Retry"})]}),u.length===0&&!n&&e.jsx("div",{className:"no-tours",children:e.jsx("p",{children:"No tours found matching your criteria."})}),u.map(s=>e.jsxs("div",{className:"tour-card",children:[e.jsxs("div",{className:"tour-header",children:[e.jsx("h3",{children:s.fullName}),e.jsx("span",{className:"tour-status",style:{backgroundColor:v(s.tourStatus)},children:s.tourStatus.toUpperCase()})]}),e.jsxs("div",{className:"tour-details",children:[e.jsxs("div",{className:"tour-info",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",s.email]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Phone:"})," ",s.phoneNumber]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Date:"})," ",new Date(s.tourDate).toLocaleDateString()]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Time:"})," ",s.tourTime]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Exam:"})," ",s.examPreparation]})]}),e.jsxs("div",{className:"tour-actions",children:[s.tourStatus==="pending"&&e.jsx("button",{onClick:()=>i(s._id,"confirmed"),className:"confirm-button",children:"Confirm Tour"}),s.tourStatus==="confirmed"&&e.jsx("button",{onClick:()=>i(s._id,"completed"),className:"complete-button",children:"Mark Complete"}),(s.tourStatus==="pending"||s.tourStatus==="confirmed")&&e.jsx("button",{onClick:()=>i(s._id,"cancelled"),className:"cancel-button",children:"Cancel Tour"})]})]}),s.adminNotes&&e.jsxs("div",{className:"admin-notes",children:[e.jsx("strong",{children:"Admin Notes:"})," ",s.adminNotes]})]},s._id))]})]})}export{S as default};
